<?phpnamespace Sistema\Util;class SysFnc {		public static function FechaActualYmdHms()	{		$time = time();        $fechaCompleta=date("Y-m-d H:i:s", $time);		return $fechaCompleta;	}    public static function FechaActualYmd()	{		$time = time();        $fechaCompleta=date("Y-m-d", $time);		return $fechaCompleta;	}        public static function rutFormat($rut,$dv)    {        if($rut!="" && $dv!=""){        return number_format($rut,-3,"",".")."-".$dv;      }else{        return "";      }     }    public static function mostrarFecha($fecha)    {       setlocale(LC_TIME, 'spanish').': ';       $valor = ucfirst(iconv('ISO-8859-1', 'UTF-8', strftime('%A %d de %B del %Y', strtotime($fecha))))."";             return $valor;    }    public static function mostrarFechaDMY($fecha)    {       $fechaStr = strtotime($fecha);       $fechaMostrar = date('d-m-Y',$fechaStr);       return $fechaMostrar;    }    public static function mostrarHoraHms($fecha)    {       $fechaStr = strtotime($fecha);       $fechaMostrar = date('H:i:s',$fechaStr);       return $fechaMostrar;    }                public static function difDays($fechaInicio)    {         $time = time();         $diferencia = strtotime(date("Y-m-d H:i:s", $time)) - strtotime($fechaInicio);         $dia = floor($diferencia/86400);         return $dia;    }        public static function correoValido($correo)    {        if($correo!=""){        $Sintaxis='#^[\w.-]+@[\w.-]+\.[a-zA-Z]{2,6}$#';            if(preg_match($Sintaxis,$correo))                return true;            else            return false;        }else{            return true;        }    }            public static function rspOK()    {        return ' <div class="modal fade" id="respuestaOK" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">               <div class="modal-dialog">                 <div class="modal-content" >                         <div >                         &nbsp;                            <div class="container-fluid">                                <div class="row">                                    <div class="col-lg-12">                                        <div class="col-lg-12 text-center" style="padding: 80px;">                                            <span><i class="fa fa-thumbs-o-up fa-5x"></i></span>                                            <h2 id="descrok"></h2>                                            </div>                                    </div>                                </div>                            </div>                            </div>                    </div>                </div>            </div>  ';    }        public static function nuevaPersona()    {        return '<div class="modal fade" id="modalRegistrarPersona" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">               <div class="modal-dialog">                 <div class="modal-content" >                                                 <div >                         &nbsp;                            <div class="container-fluid">                                <div class="row">                                    <div class="col-lg-12">                                        <div class="panel panel-info">                                            <div class="panel-heading">                                            Registrar Nuevo                                         </div>                                        <div class="panel-body">                                            <div id="alertaP1"></div>                                            <div class="form-group input-group">                                               <span class="input-group-addon"><i class="fa fa-user"></i> Tipo de Persona</span>                                               <select class="form-control" id="tipoP1">                                                    <option value="natural">Natural</option>                                                    <option value="juridica">Juridica</option>                                               </select>                                            </div>                                            <div id="mostrarDatosP1">                                            <div class="form-group input-group">                                               <span class="input-group-addon">Rut</span>                                               <input type="text" class="form-control" id="rutP1"/>                                                                                           </div>                                            <div id="mostrarPersonaNatual">                                                <div class="form-group input-group">                                                   <span class="input-group-addon">Dni</span>                                                   <input type="text" class="form-control" id="dniP1"/>                                                </div>                                                <div class="form-group input-group">                                                   <span class="input-group-addon">Nombres</span>                                                   <input type="text" class="form-control" id="nombreP1"/>                                                </div>                                                <div class="form-group input-group">                                                    <span class="input-group-addon">Apellido P</span>                                                    <input type="text" id="apellidoP1" class="form-control"/>                                                </div>                                                <div class="form-group input-group">                                                       <span class="input-group-addon">Apellido M</span>                                                    <input type="text" id="apellido2P1" class="form-control"/>                                                </div>                                            </div>                                            <div id="mostrarPersonaJuridica">                                                <div class="form-group input-group">                                                   <span class="input-group-addon">Razon Social</span>                                                   <input type="text" class="form-control" id="nombreRazonP1"/>                                                </div>                                            </div>                                                                                                                                    <div class="form-group input-group">                                                <span class="input-group-addon"><i class="fa fa-phone"></i></span>                                                <input type="text" class="form-control" id="telefonoP1"/>                                            </div>                                            <div class="form-group input-group">                                                <span class="input-group-addon">@</span>                                                <input type="text" class="form-control" id="correoP1"/>                                            </div>                                            </div>                                                                                      <div align="right">                                            <button data-dismiss="modal"  class="btn btn-danger">Cancelar</button>                                            <button id="btnRegistrarNuevaPersona" class="btn btn-success">Registrar</button>                                            </div>                                        </div>                                                                                </div>                                    </div>                                </div>                            </div>                            </div>                    </div>                </div>            </div>            <script>$("#mostrarDatosP1").hide();                $("input#rutP1").rut({validateOn: "change"}).on("rutInvalido", function(){$("#alertaP1").html("<font color=red>Error: Rut Invalido</font>");$("#btnRegistrarNuevaPersona").attr("disabled","disabled");});                $("input#rutP1").rut({validateOn: "change"}).on("rutValido", function(){$("#alertaP1").html("");$("#btnRegistrarNuevaPersona").removeAttr("disabled");})                                 $("#rutP1").change(function(){                    if($(this).val()==""){                        $("#alertaP1").html("");                        $("#btnRegistrarNuevaPersona").removeAttr("disabled");                    }                });                                                $("#tipoP1").change(function(){                    $("#alertaP1").html("");                    $("#rutP1").val("");$("#dniP1").val("");$("#nombreP1").val("");$("#apellidoP1").val("");                    $("#apellido2P1").val("");$("#nombreRazonP1").val("");$("#telefonoP1").val("");$("#correoP1").val("");                    if($(this).val()==""){                        $("#mostrarDatosP1").hide(500);                        }else{                                                        if($(this).val()=="natural"){                                $("#mostrarPersonaJuridica").hide();                                $("#mostrarPersonaNatual").show();                            }else{                               $("#mostrarPersonaJuridica").show();                               $("#mostrarPersonaNatual").hide();                            }                            $("#mostrarDatosP1").show(700);                                                                            }                                    });                $("#tipoP1").trigger("change");              function registrarPersonaNueva(){                                    var tipop1 = $("#tipoP1").val();                    var rutp1 =$("#rutP1").val();                    var dnip1 =$("#dniP1").val();                    var nombrep1 =$("#nombreP1").val();                    var apellidop1 =$("#apellidoP1").val();                    var apellido2p1 =$("#apellido2P1").val();                    var telefonop1 =$("#telefonoP1").val();                    var correop1 =$("#correoP1").val();                                                            if(tipop1=="")                    {                        $("#alertaP1").html("<font color=red>Error: No ha seleccionado tipo de persona</font>");                        return;                    }                    if(tipop1=="juridica")                    {                                              nombrep1 = $("#nombreRazonP1").val();                        if (rutp1==""){                            $("#alertaP1").html("<font color=red>Error: Rut es obligatorio para persona Juridica</font>");                        return;                        }                    }                    var vector = new Array();                    var parametros = {"tipop1":tipop1,"rutp1":rutp1,"dnip1":dnip1,"nombrep1":nombrep1,"apellidop1":apellidop1,"apellido2p1":apellido2p1,"telefonop1":telefonop1,"correop1":correop1};                                      	$.ajax( {             	        async:false,                            cache:false,                 		data : parametros,                        url : "'.$_SERVER['REDIRECT_BASE'].'conserje/cfg/regper",                		type : "post",                		success : function(r) {                            if(r.status=="ok"){                                                                $("#rutP1").val("");                                $("#dniP1").val("");                                $("#nombreP1").val("");                                $("#apellidoP1").val("");                                $("#apellido2P1").val("");                                $("#telefonoP1").val("");                                $("#correoP1").val("");                                vector["id"] = r.idpersona;                                vector["rut"] = rutp1;                                vector["dv"] = r.dv;                                vector["dni"] = dnip1;                                vector["nombre"] = nombrep1;                                vector["apellido1"] = apellidop1;                                vector["apellido2"] = apellido2p1;                                vector["telefono"] = telefonop1;                                vector["correo"] = correop1;                                vector["rutformat"] = r.rutformat;                                                                $("#descrok").text("Se ha registrado la persona satisfactoriamente...");                                $("#respuestaOK").modal("show");                                setTimeout(function(){$("#respuestaOK").modal("hide");},1500);                                                                $("#modalRegistrarPersona").modal("hide");                                                            }else{                                $("#alertaP1").html("<font color=red>"+r.error+"</font>");                            }                		}                    });                                                                              return vector;                                    }                function limpiarPersona(){                                        $("#alertaP1").html("");                    $("#tipoP1").val("");                    $("#rutP1").val("");                    $("#dniP1").val("");                    $("#nombreP1").val("");                    $("#nombreRazonP1").val("");                    $("#apellidoP1").val("");                    $("#apellido2P1").val("");                    $("#telefonoP1").val("");                    $("#correoP1").val("");                    $("#mostrarDatosP1").hide();                }            </script>             ';    }    	public static function detalleEnc($m){	                 return '<div class="row">                                    <div class="col-lg-12">                                        <div class="panel panel-info">                                            <div class="panel-heading">                                            La encomienda se encuentra con el estado &nbsp;<strong>'.$m['estado'].'</strong>                                         </div>                                        <div class="panel-body" id="panelDetalleEncomienda">                                                                                        <div class="form-group input-group">                                               <span class="input-group-addon"><i class="fa fa-home"></i></span>                                               <input type="text" class="form-control" value="'.$m['dpto'].'"/>                                            </div>                                            <label>Habitan en el departamento</label>                                            <div class="table-responsive">                                                <table class="table table-condensed table-striped">                                                <tbody>                                                '.$m['habitan'].'                                                </tbody>                                                </table>                                                </div>                                            <div class="form-group input-group">                                                   <span class="input-group-addon">Remitente</span>                                                <input type="text" class="form-control" value="'.$m['remite'].'"/>                                            </div>                                            <div class="form-group input-group">                                                <span class="input-group-addon">Recepciono</span>                                                <input type="text" class="form-control" value="'.$m['fecha'].'"/>                                            </div>                                            <div class="form-group">                                                                                            <label>Detalle <a href="#">Ver Foto</a></label>                                                                    <textarea id="detalleDet" rows="2" class="form-control">'.$m['detalle'].'</textarea>                                            </div>                                             <div class="form-group input-group">                                                   <span class="input-group-addon">Retirado</span>                                                <input type="text" class="form-control" value="'.$m['retirado'].'"/>                                            </div>                                             <div class="form-group">                                                                                            <label>Observacion</label>                                                                    <textarea id="detalleDet" rows="2" class="form-control">'.$m['observacion'].'</textarea>                                            </div>                                            <div class="form-group">                                                                                            <i>Ingresado por: '.$m['ingresado'].'<br/>Actualizado por: '.$m['actualizado'].'</i><br/>                                             <i>Ultima fecha: '.$m['date_update'].'                                                                                                               </div>                                                                                      <div align="right">                                            <button data-dismiss="modal"  class="btn btn-danger">Cerrar</button>                                            </div>                                        </div>                                                                                </div>                                    </div>                                </div>';	}                public static function cargarVistaImagen(){                return '       <div class="modal fade" id="modalViewPhoto" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">               <div class="modal-dialog modal-lg">                 <div class="modal-content" >                         <div >                         &nbsp;                            <div class="container-fluid">                                <div class="row">                                    <div class="col-lg-12">                                        <div class="panel panel-primary">                                        <div class="panel-body">                                            <div align="center">                                            <div id="viewPhotoModal"></div>                                            <br/>                                                <button id="aviewimgHide"  class="btn btn-danger">&nbsp;&nbsp;&nbsp;Salir&nbsp;&nbsp;&nbsp;</button>                                            </div>                                            </div>                                           </div>                                    </div>                                </div>                            </div>                            </div>                    </div>                </div>            </div>            ';            }            public static function  repeatedElements($array)            {            	$repeated = array();                         	foreach( (array)$array as $value )            	{            		$inArray = false;                         		foreach( $repeated as $i => $rItem )            		{            			if( $rItem['value'] === $value )            			{            				$inArray = true;            				++$repeated[$i]['count'];            			}            		}                         		if( false === $inArray )            		{            			$i = count($repeated);            			$repeated[$i] = array();            			$repeated[$i]['value'] = $value;            			$repeated[$i]['count'] = 1;            		}            	}                         	sort($repeated);                         	return $repeated;            }	}